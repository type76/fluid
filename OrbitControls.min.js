(function(){function G(d){this.object=d;this.target=new THREE.Vector3;this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=Infinity;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.enableDamping=false;this.dampingFactor=0.25;var e=this,l,k,s=0,q=0,r=1,o=new THREE.Vector3,t=false;this.getPolarAngle=function(){return k};this.getAzimuthalAngle=function(){return l};this.rotateLeft=function(c){q-=c};this.rotateUp=function(c){s-=
c};this.panLeft=function(){var c=new THREE.Vector3;return function(m){var i=this.object.matrix.elements;c.set(i[0],i[1],i[2]);c.multiplyScalar(-m);o.add(c)}}();this.panUp=function(){var c=new THREE.Vector3;return function(m){var i=this.object.matrix.elements;c.set(i[4],i[5],i[6]);c.multiplyScalar(m);o.add(c)}}();this.pan=function(c,m,i,p){if(e.object instanceof THREE.PerspectiveCamera){i=e.object.position.clone().sub(e.target).length();i*=Math.tan(e.object.fov/2*Math.PI/180);e.panLeft(2*c*i/p);e.panUp(2*
m*i/p)}else if(e.object instanceof THREE.OrthographicCamera){e.panLeft(c*(e.object.right-e.object.left)/i);e.panUp(m*(e.object.top-e.object.bottom)/p)}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")};this.dollyIn=function(c){if(e.object instanceof THREE.PerspectiveCamera)r/=c;else if(e.object instanceof THREE.OrthographicCamera){e.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*c));e.object.updateProjectionMatrix();t=true}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")};
this.dollyOut=function(c){if(e.object instanceof THREE.PerspectiveCamera)r*=c;else if(e.object instanceof THREE.OrthographicCamera){e.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/c));e.object.updateProjectionMatrix();t=true}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")};this.update=function(){var c=new THREE.Vector3,m=(new THREE.Quaternion).setFromUnitVectors(d.up,new THREE.Vector3(0,1,0)),i=m.clone().inverse(),
p=new THREE.Vector3,h=new THREE.Quaternion;return function(){var a=this.object.position;c.copy(a).sub(this.target);c.applyQuaternion(m);l=Math.atan2(c.x,c.z);k=Math.atan2(Math.sqrt(c.x*c.x+c.z*c.z),c.y);l+=q;k+=s;l=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,l));k=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,k));k=Math.max(1.0E-6,Math.min(Math.PI-1.0E-6,k));var n=c.length()*r;n=Math.max(this.minDistance,Math.min(this.maxDistance,n));this.target.add(o);c.x=n*Math.sin(k)*
Math.sin(l);c.y=n*Math.cos(k);c.z=n*Math.sin(k)*Math.cos(l);c.applyQuaternion(i);a.copy(this.target).add(c);this.object.lookAt(this.target);if(this.enableDamping===true){q*=1-this.dampingFactor;s*=1-this.dampingFactor}else s=q=0;r=1;o.set(0,0,0);if(t||p.distanceToSquared(this.object.position)>1.0E-6||8*(1-h.dot(this.object.quaternion))>1.0E-6){p.copy(this.object.position);h.copy(this.object.quaternion);t=false;return true}return false}}()}THREE.OrbitControls=function(d,e){function l(b,j){var E=a.domElement===
document?a.domElement.body:a.domElement;h.pan(b,j,E.clientWidth,E.clientHeight)}function k(){return Math.pow(0.95,a.zoomSpeed)}function s(b){if(a.enabled!==false){b.preventDefault();if(b.button===a.mouseButtons.ORBIT){if(a.enableRotate===false)return;g=f.ROTATE;n.set(b.clientX,b.clientY)}else if(b.button===a.mouseButtons.ZOOM){if(a.enableZoom===false)return;g=f.DOLLY;u.set(b.clientX,b.clientY)}else if(b.button===a.mouseButtons.PAN){if(a.enablePan===false)return;g=f.PAN;v.set(b.clientX,b.clientY)}if(g!==
f.NONE){document.addEventListener("mousemove",q,false);document.addEventListener("mouseup",r,false);a.dispatchEvent(C)}}}function q(b){if(a.enabled!==false){b.preventDefault();var j=a.domElement===document?a.domElement.body:a.domElement;if(g===f.ROTATE){if(a.enableRotate===false)return;w.set(b.clientX,b.clientY);x.subVectors(w,n);h.rotateLeft(2*Math.PI*x.x/j.clientWidth*a.rotateSpeed);h.rotateUp(2*Math.PI*x.y/j.clientHeight*a.rotateSpeed);n.copy(w)}else if(g===f.DOLLY){if(a.enableZoom===false)return;
y.set(b.clientX,b.clientY);z.subVectors(y,u);if(z.y>0)h.dollyIn(k());else z.y<0&&h.dollyOut(k());u.copy(y)}else if(g===f.PAN){if(a.enablePan===false)return;A.set(b.clientX,b.clientY);B.subVectors(A,v);l(B.x,B.y);v.copy(A)}g!==f.NONE&&a.update()}}function r(){if(a.enabled!==false){document.removeEventListener("mousemove",q,false);document.removeEventListener("mouseup",r,false);a.dispatchEvent(D);g=f.NONE}}function o(b){if(!(a.enabled===false||a.enableZoom===false||g!==f.NONE)){b.preventDefault();b.stopPropagation();
var j=0;if(b.wheelDelta!==undefined)j=b.wheelDelta;else if(b.detail!==undefined)j=-b.detail;if(j>0)h.dollyOut(k());else j<0&&h.dollyIn(k());a.update();a.dispatchEvent(C);a.dispatchEvent(D)}}function t(b){if(!(a.enabled===false||a.enableKeys===false||a.enablePan===false))switch(b.keyCode){case a.keys.UP:l(0,a.keyPanSpeed);a.update();break;case a.keys.BOTTOM:l(0,-a.keyPanSpeed);a.update();break;case a.keys.LEFT:l(a.keyPanSpeed,0);a.update();break;case a.keys.RIGHT:l(-a.keyPanSpeed,0);a.update()}}function c(b){if(a.enabled!==
false){switch(b.touches.length){case 1:if(a.enableRotate===false)return;g=f.TOUCH_ROTATE;n.set(b.touches[0].pageX,b.touches[0].pageY);break;case 2:if(a.enableZoom===false)return;g=f.TOUCH_DOLLY;var j=b.touches[0].pageX-b.touches[1].pageX;b=b.touches[0].pageY-b.touches[1].pageY;u.set(0,Math.sqrt(j*j+b*b));break;case 3:if(a.enablePan===false)return;g=f.TOUCH_PAN;v.set(b.touches[0].pageX,b.touches[0].pageY);break;default:g=f.NONE}g!==f.NONE&&a.dispatchEvent(C)}}function m(b){if(a.enabled!==false){b.preventDefault();
b.stopPropagation();var j=a.domElement===document?a.domElement.body:a.domElement;switch(b.touches.length){case 1:if(a.enableRotate===false)break;if(g!==f.TOUCH_ROTATE)break;w.set(b.touches[0].pageX,b.touches[0].pageY);x.subVectors(w,n);h.rotateLeft(2*Math.PI*x.x/j.clientWidth*a.rotateSpeed);h.rotateUp(2*Math.PI*x.y/j.clientHeight*a.rotateSpeed);n.copy(w);a.update();break;case 2:if(a.enableZoom===false)break;if(g!==f.TOUCH_DOLLY)break;j=b.touches[0].pageX-b.touches[1].pageX;b=b.touches[0].pageY-b.touches[1].pageY;
y.set(0,Math.sqrt(j*j+b*b));z.subVectors(y,u);if(z.y>0)h.dollyOut(k());else z.y<0&&h.dollyIn(k());u.copy(y);a.update();break;case 3:if(a.enablePan===false)break;if(g!==f.TOUCH_PAN)break;A.set(b.touches[0].pageX,b.touches[0].pageY);B.subVectors(A,v);l(B.x,B.y);v.copy(A);a.update();break;default:g=f.NONE}}}function i(){if(a.enabled!==false){a.dispatchEvent(D);g=f.NONE}}function p(b){b.preventDefault()}var h=new G(d);this.domElement=e!==undefined?e:document;Object.defineProperty(this,"constraint",{get:function(){return h}});
this.getPolarAngle=function(){return h.getPolarAngle()};this.getAzimuthalAngle=function(){return h.getAzimuthalAngle()};this.enabled=true;this.center=this.target;this.enableZoom=true;this.zoomSpeed=1;this.enableRotate=true;this.rotateSpeed=1;this.enablePan=true;this.keyPanSpeed=7;this.autoRotate=false;this.autoRotateSpeed=2;this.enableKeys=true;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var a=this,n=new THREE.Vector2,
w=new THREE.Vector2,x=new THREE.Vector2,v=new THREE.Vector2,A=new THREE.Vector2,B=new THREE.Vector2,u=new THREE.Vector2,y=new THREE.Vector2,z=new THREE.Vector2,f={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},g=f.NONE;this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=this.object.zoom;var F={type:"change"},C={type:"start"},D={type:"end"};this.update=function(){this.autoRotate&&g===f.NONE&&h.rotateLeft(2*Math.PI/60/60*a.autoRotateSpeed);
h.update()===true&&this.dispatchEvent(F)};this.reset=function(){g=f.NONE;this.target.copy(this.target0);this.object.position.copy(this.position0);this.object.zoom=this.zoom0;this.object.updateProjectionMatrix();this.dispatchEvent(F);this.update()};this.dispose=function(){this.domElement.removeEventListener("contextmenu",p,false);this.domElement.removeEventListener("mousedown",s,false);this.domElement.removeEventListener("mousewheel",o,false);this.domElement.removeEventListener("MozMousePixelScroll",
o,false);this.domElement.removeEventListener("touchstart",c,false);this.domElement.removeEventListener("touchend",i,false);this.domElement.removeEventListener("touchmove",m,false);document.removeEventListener("mousemove",q,false);document.removeEventListener("mouseup",r,false);window.removeEventListener("keydown",t,false)};this.domElement.addEventListener("contextmenu",p,false);this.domElement.addEventListener("mousedown",s,false);this.domElement.addEventListener("mousewheel",o,false);this.domElement.addEventListener("MozMousePixelScroll",
o,false);this.domElement.addEventListener("touchstart",c,false);this.domElement.addEventListener("touchend",i,false);this.domElement.addEventListener("touchmove",m,false);window.addEventListener("keydown",t,false);this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;Object.defineProperties(THREE.OrbitControls.prototype,{object:{get:function(){return this.constraint.object}},target:{get:function(){return this.constraint.target},
set:function(d){console.warn("THREE.OrbitControls: target is now immutable. Use target.set() instead.");this.constraint.target.copy(d)}},minDistance:{get:function(){return this.constraint.minDistance},set:function(d){this.constraint.minDistance=d}},maxDistance:{get:function(){return this.constraint.maxDistance},set:function(d){this.constraint.maxDistance=d}},minZoom:{get:function(){return this.constraint.minZoom},set:function(d){this.constraint.minZoom=d}},maxZoom:{get:function(){return this.constraint.maxZoom},
set:function(d){this.constraint.maxZoom=d}},minPolarAngle:{get:function(){return this.constraint.minPolarAngle},set:function(d){this.constraint.minPolarAngle=d}},maxPolarAngle:{get:function(){return this.constraint.maxPolarAngle},set:function(d){this.constraint.maxPolarAngle=d}},minAzimuthAngle:{get:function(){return this.constraint.minAzimuthAngle},set:function(d){this.constraint.minAzimuthAngle=d}},maxAzimuthAngle:{get:function(){return this.constraint.maxAzimuthAngle},set:function(d){this.constraint.maxAzimuthAngle=
d}},enableDamping:{get:function(){return this.constraint.enableDamping},set:function(d){this.constraint.enableDamping=d}},dampingFactor:{get:function(){return this.constraint.dampingFactor},set:function(d){this.constraint.dampingFactor=d}},noZoom:{get:function(){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");return!this.enableZoom},set:function(d){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");this.enableZoom=
!d}},noRotate:{get:function(){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");return!this.enableRotate},set:function(d){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");this.enableRotate=!d}},noPan:{get:function(){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");return!this.enablePan},set:function(d){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");
this.enablePan=!d}},noKeys:{get:function(){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");return!this.enableKeys},set:function(d){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");this.enableKeys=!d}},staticMoving:{get:function(){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");return!this.constraint.enableDamping},set:function(d){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");
this.constraint.enableDamping=!d}},dynamicDampingFactor:{get:function(){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");return this.constraint.dampingFactor},set:function(d){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");this.constraint.dampingFactor=d}}})})();
